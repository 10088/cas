---
layout: default
title: CAS - QR Code Authentication
category: Authentication
---

# QR Code Authentication

QR Code authentication is a strategy that allows the user to scan a QR code, generated by the
CAS server, using a mobile device and subsequently login after having successfully validated it.

The QR code contains a special identifier embedded within that allows the mobile device to establish a communication
channel using web sockets to the CAS server. Once established, the mobile device may collect credentials from the user
and submit those to CAS for verification. The return result, expected as a `JWT` that is generated by CAS,
is then passed along to the web socket channel for verification and successful login. Subsequent login attempts can allow
for a completely *passwordless* scenario such that the mobile device can continue to re-use the JWT
for authentication attempts, allowing the end user to *scan and proceed*.

Support is enabled by including the following dependency in the WAR overlay:

```xml
<dependency>
  <groupId>org.apereo.cas</groupId>
  <artifactId>cas-server-support-qrlogin</artifactId>
  <version>${cas.version}</version>
</dependency>
```

## Configuration

To see the relevant list of CAS 
properties, please [review this guide](../configuration/Configuration-Properties.html#qr-authentication).

## Web Socket Connection

The process of connecting to a web socket connection certainly varies for each mobile app framework. At a high level, 
mobile devices should establish a web socket connection to the CAS server via the `/cas/qr-websocket` endpoint.
The payload must then be sent to the `/qr/accept` path as a map and must contain a `token` field that 
carries the pre-authenticated JWT. The payload header must point to the channel id obtained 
from the QR code under the header name `QR_AUTHENTICATION_CHANNEL_ID`.

The following code snippet demonstrates this process as an example:

```javascript 
let socket = new SockJS('https://sso.example.org/cas/qr-websocket');
let stompClient = Stomp.over(socket);
let payload = JSON.stringify({'token': '...'});
let channelId = "...";
stompClient.send("/qr/accept", {'QR_AUTHENTICATION_CHANNEL_ID': channelId}, payload);
```

## Obtaining JWT 

The mobile device should ask for and then submit user credentials to the CAS 
server using the [REST protocol](../protocol/REST-Protocol.html#jwt-ticket-granting-tickets) to 
obtain a JWT. Once received, the device may cache the JWT and establish a *session* for code reuse later. 
The JWT should be sent to the CAS server's web socket channel for validation and login. The generated
JWT is automatically signed and encrypted by CAS and can only be decoded by the CAS server.

